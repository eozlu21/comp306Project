
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title th:text="${category} + ' Products'">Category Products</title>
  <link rel="stylesheet" href="/css/homepageScreen.css">
  <link rel="stylesheet" href="/css/navbar.css">
  <script>
    // Check if this page should reload
    if (sessionStorage.getItem("shouldReload") === "true") {
      // Remove the flag and reload the page
      sessionStorage.removeItem("shouldReload");
      window.location.reload();
    }
  </script>
</head>
<body>
<div class="container">
  <header>
    <div th:insert="fragments/navbar :: navbar"></div>
    
    <!-- Filter Box Moved to Header -->
    <aside class="filter-box">
      <h2 th:text="'Filter ' + ${category} + 's'">Filter</h2>
      <form th:action="@{/products/{category}/filter(category=${category})}" method="get">
        <!-- Filters content remains unchanged -->
        <div th:switch="${category}">
          <!-- Filter content (phones, laptops, cameras) here -->
        </div>
        <input type="hidden" name="userID" th:value="${userId}" />
        <button type="submit" class="filter-button">Apply Filters</button>
      </form>
    </aside>
    
    <!-- Category Filter Links -->
    <div class="category-buttons">
      <a th:href="@{/products/phone(userID=${userId})}" class="category-btn">Phones</a>
      <a th:href="@{/products/laptop(userID=${userId})}" class="category-btn">Laptops</a>
      <a th:href="@{/products/camera(userID=${userId})}" class="category-btn">Cameras</a>
    </div>
  </header>

  <main>
    <h2 th:text="'Products in ' + ${category} + ':'">Selected Category</h2>
    <div class="product-list">
      <!-- Iterate over the products list -->
      <div class="product" th:each="product : ${products}">
        <img th:src="${product.imageURL}" alt="Product Image" class="product-image">
        <div class="product-details">
          <p class="product-name" th:text="${product.productName}">Product Name</p>
          <p class="brand" th:text="'Brand: ' + ${product.brand}">Brand</p>
          <p class="price" th:text="'Price: â‚º' + ${product.price}">Price</p>
        </div>
        <div class="product-actions">
          <a class="details-button" th:href="@{/productDetails/{id}(id=${product.productId}, userID=${userId})}">
            Show Details
          </a>
          <form th:action="@{/addToCart}" method="post" class="add-to-cart-form">
            <input type="hidden" name="productId" th:value="${product.productId}" />
            <input type="hidden" name="userId" th:value="${userId}" />
            <input type="hidden" name="quantity" value="1" />
            <button type="submit" class="add-to-cart-button">Add to Cart</button>
          </form>
        </div>
      </div>
    </div>
  </main>
</div>
</body>
</html>
